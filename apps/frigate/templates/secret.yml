apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}
  namespace: {{ $.Release.Namespace }}
  labels:
    {{- include "common.resource-labels" . | indent 4 }}
type: Opaque
stringData:
  frigate.yml: |
    mqtt:
      host: {{ .Values.mqtt.serviceName }}.{{ .Values.mqtt.namespace | default .Release.Namespace }}.svc.cluster.local

    database:
      path: /db/frigate.db

    cameras:
      {{- range .Values.cameras }}
        {{ .name }}:
          ffmpeg:
            inputs:
              - path: {{ .url }}
                roles:
                  - detect
                  - rtmp
          detect:
            width: {{ .width }}
            height: {{ .height }}
          # motion:
          #   mask:
          #     - 0,461,3,0,1919,0,1919,843,1699,492,1344,458,1346,336,973,317,869,375,866,432
        {{- end }}